# DiCIPHR-Pipeline

## Running the Pipeline
To run the pipeline, follow the steps below. Ensure that you have the necessary permissions and resources to execute the commands.
 
## Step 1: Clone the Repository
First, clone the repository to your local machine. You can do this using the following command:
 
git clone https://github.com/SaiKrishnaChaitanya24/DiCIPHR-Pipeline.git
 
## Step 2: Build the Singularity Container
Build the diciphr_pipeline.sif Singularity container using the provided Singularity definition file. This ensures you have the necessary environment to run the pipeline. Use the following command:
 
sbatch --cpus-per-task=4 --mem=32G --wrap="apptainer build ./DiCIPHR-Pipeline/diciphr_pipeline.sif ./DiCIPHR-Pipeline/Singularity.def"

## Step 3: Test the Singularity Container

Ensure that the Singularity container was built correctly by testing it with the following commands:

singularity shell ./DiCIPHR-Pipeline/diciphr_pipeline.sif 


/usr/local/bin/Scripts/test_container.sh 

If the container was built successfully, the output will confirm that the test was successful.
 
## Step 4: Create Output Directory
Create a directory to store the output files generated by the pipeline. Use the command below to create the output directory:
 
mkdir -p ./DiCIPHR-Pipeline/output
 
## Step 5: Run the Pipeline
Run the pipeline using the Singularity container. You need to specify the subject name, the absolute path to the T1 image, the absolute path to the DWI image, and the output directory. The T1 and DWI images need to be .nii files, and the T1 image needs to be cropped. Use the command below:
 
sbatch --cpus-per-task=4 --mem=32G --wrap="apptainer run --no-home --bind /noTopup:/noTopup --bind ./DiCIPHR-Pipeline/output:/output ./DiCIPHR-Pipeline/diciphr_pipeline.sif -s {subject_name} -i {T1_image_absolute_path} -d {DWI_absolute_path} -o /output"
 
Note: /noTopup:/noTopup needs to be replaced with the absolute path where your data is stored.
 
Remember to replace {subject_name}, {T1_image_absolute_path}, and {DWI_absolute_path} with the actual values for your specific data (with absolute path).
